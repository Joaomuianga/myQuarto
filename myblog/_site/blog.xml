<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>João Muianga</title>
<link>https://bejewelled-nougat-3b99a7.netlify.app/blog.html</link>
<atom:link href="https://bejewelled-nougat-3b99a7.netlify.app/blog.xml" rel="self" type="application/rss+xml"/>
<description>This is João Muianga&#39;s personal Blog to share contents</description>
<generator>quarto-1.5.53</generator>
<lastBuildDate>Tue, 23 Jul 2024 22:00:00 GMT</lastBuildDate>
<item>
  <title>Choropleth map with ggplot2 and viridis</title>
  <dc:creator>João Muianga</dc:creator>
  <link>https://bejewelled-nougat-3b99a7.netlify.app/posts/maps_viridis/maps.html</link>
  <description><![CDATA[ 




<section id="how-to-build" class="level1">
<h1>How to build</h1>
<p>This post shows the simple way to load geospatial data, merge with different data formats (csv, excel, etc) and build a Choropleth map with ggplot2, viridis in R</p>
</section>
<section id="about-choroplet-map" class="level1">
<h1>About Choroplet map</h1>
<p>Choropleth map is composed of colored polygons. It is used to represent spatial variations of a quantity. Making choropleth maps require two main types of inputs 1- Geometry information: - This can either be a supplied GeoJSON file where each feature has either an <code>id</code> field or some identifying value in <code>properties</code>; or - one of the built-in geometries within <code>plot_ly</code> 2- A list of values indexed by feature identifier.</p>
</section>
<section id="import-shapefile" class="level1">
<h1>Import shapefile</h1>
<p>I will load essential libraries to import data and geospatial analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(rio,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import function</span></span>
<span id="cb1-2">               here,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># file path</span></span>
<span id="cb1-3">               scales,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># percent function</span></span>
<span id="cb1-4">               janitor,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary table </span></span>
<span id="cb1-5">               sf,              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to manager spatial data using a simple feature format</span></span>
<span id="cb1-6">               tidyverse        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data management and visualization</span></span>
<span id="cb1-7">               )</span></code></pre></div>
</div>
<p>I downloaded the US states shapefile at <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html">census.gov</a> website, it’s for public use. Use <code>read_sf()</code> function to import the shapefile in your local computer; use <code>here()</code> function to say what is the file path.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import shapefile</span></span>
<span id="cb2-2">us_states_sf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gis"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spf_usa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"usa_shapefile.shp"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-3">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() </span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|code-fold: false</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(us_states_sf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 9 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -103.0026 ymin: 30.17394 xmax: -75.24227 ymax: 40.6388
Geodetic CRS:  NAD83
# A tibble: 5 × 10
  statefp statens  affgeoid    geoid stusps name           lsad    aland  awater
  &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 28      01779790 0400000US28 28    MS     Mississippi    00    1.22e11 3.93e 9
2 37      01027616 0400000US37 37    NC     North Carolina 00    1.26e11 1.35e10
3 40      01102857 0400000US40 40    OK     Oklahoma       00    1.78e11 3.37e 9
4 51      01779803 0400000US51 51    VA     Virginia       00    1.02e11 8.53e 9
5 54      01779805 0400000US54 54    WV     West Virginia  00    6.23e10 4.89e 8
# ℹ 1 more variable: geometry &lt;MULTIPOLYGON [°]&gt;</code></pre>
</div>
</div>
</section>
<section id="basic-map" class="level1">
<h1>Basic map</h1>
<p>Now we have a geospatial object called <code>us_stat_sf</code>, we can plot a basic map using <code>ggplot()</code> and <code>geom_df()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> us_states_sf)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/maps_viridis/maps_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>basic_map</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="read-the-dataset" class="level1">
<h1>Read the dataset</h1>
<p>The database is available for download at the <a href="https://healthdata.gov/resource/g62h-syeh.json?$limit=50000">healthData.gov</a>, To have the <code>New hospitalization</code> a calculation among some core indicators that match with inpatients admission definition cases and were group by states.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print first 5 rows of the dataset containing hospitalization</span></span>
<span id="cb6-2">hosp_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"usa_hosp.csv"</span>))</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(hosp_data, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  state new_hospitalization
1    AK               10651
2    AL              134959
3    AR               77594
4    AS                 225
5    AZ              173993</code></pre>
</div>
</div>
</section>
<section id="merge-geospatial-and-numeric-data" class="level1">
<h1>Merge geospatial and numeric data</h1>
<p>The <code>id</code> in common is shapefile: <code>stusps</code> and dataset <code>state</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join or merge geospatial and numeric data</span></span>
<span id="cb8-2">us_states_sf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states_sf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(hosp_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stusps"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"state"</span>))</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(us_states_sf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 10 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -103.0026 ymin: 30.17394 xmax: -75.24227 ymax: 40.6388
Geodetic CRS:  NAD83
# A tibble: 5 × 11
  statefp statens  affgeoid    geoid stusps name           lsad    aland  awater
  &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 28      01779790 0400000US28 28    MS     Mississippi    00    1.22e11 3.93e 9
2 37      01027616 0400000US37 37    NC     North Carolina 00    1.26e11 1.35e10
3 40      01102857 0400000US40 40    OK     Oklahoma       00    1.78e11 3.37e 9
4 51      01779803 0400000US51 51    VA     Virginia       00    1.02e11 8.53e 9
5 54      01779805 0400000US54 54    WV     West Virginia  00    6.23e10 4.89e 8
# ℹ 2 more variables: geometry &lt;MULTIPOLYGON [°]&gt;, new_hospitalization &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="basic-map-with-numeric-variable" class="level1">
<h1>Basic map with numeric variable</h1>
<p>We will plot a basic choropleth map to show inpatients admission distribution by US states</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(us_states_sf) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> new_hospitalization))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/maps_viridis/maps_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="customized-choropleth-map" class="level1">
<h1>Customized choropleth map</h1>
<p>This step will transform and give a good image to the plot, adding color palette, legend, tittle, scale, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(us_states_sf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> new_hospitalization))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb11-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,</span>
<span id="cb11-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> us_states_sf, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> stusps), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(</span>
<span id="cb11-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of inpatients admission"</span>,</span>
<span id="cb11-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>comma,</span>
<span id="cb11-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800000</span>),</span>
<span id="cb11-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guide =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(</span>
<span id="cb11-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keyheight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb11-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keywidth =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb11-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb11-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb11-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb11-17">    )</span>
<span id="cb11-18">  )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"COVID-19: Hospitalization in USA"</span>,</span>
<span id="cb11-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total of inpatients admission from 2020-01-01 to 2024-04-27 in 50 states"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#22211d"</span>),</span>
<span id="cb11-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f5f5f2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb11-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background  =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f5f5f2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb11-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.background  =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f5f5f2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb11-26">    </span>
<span id="cb11-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4e4d47"</span>,</span>
<span id="cb11-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span></span>
<span id="cb11-30">      )</span>
<span id="cb11-31">    ),</span>
<span id="cb11-32"></span>
<span id="cb11-33">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb11-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4e4d47"</span>,</span>
<span id="cb11-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(</span>
<span id="cb11-37">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.43</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb11-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span></span>
<span id="cb11-39">      )</span>
<span id="cb11-40">    ),</span>
<span id="cb11-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb11-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4e4d47"</span>,</span>
<span id="cb11-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(</span>
<span id="cb11-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">99</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb11-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span></span>
<span id="cb11-47">      )</span>
<span id="cb11-48">    ),</span>
<span id="cb11-49"></span>
<span id="cb11-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb11-51">  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/maps_viridis/maps_files/figure-html/map-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>



</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div> ]]></description>
  <category>R</category>
  <category>API</category>
  <category>Choropleth map</category>
  <category>Viridis</category>
  <category>Hospitalization</category>
  <category>COVID-19</category>
  <guid>https://bejewelled-nougat-3b99a7.netlify.app/posts/maps_viridis/maps.html</guid>
  <pubDate>Tue, 23 Jul 2024 22:00:00 GMT</pubDate>
  <media:content url="https://bejewelled-nougat-3b99a7.netlify.app/posts/maps_viridis/photo.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>COVID-19 Forecast: US Hospitalizations data</title>
  <dc:creator>João Muianga</dc:creator>
  <link>https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast.html</link>
  <description><![CDATA[ 




<section id="request-data-using-api-in-r" class="level1">
<h1>Request data using API in R</h1>
<p>APIs allow programmers to request data directly from Server API or website through an Application Programming Interface. The first step is making a request to access the data in a certain website, the API server (own of data) will send back a response. There are several types of requests that one can make to an API server <code>GET, POST, PUT</code>. Four our purpose we’ll be asking for data using <code>GET</code> requests.</p>
<p>To create a <code>GET</code> request we need to use the <code>GET()</code> function from the <code>httr</code> library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(httr,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># request url using GET() function</span></span>
<span id="cb1-2">               jsonlite,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert JSON file to a data frame in R</span></span>
<span id="cb1-3">               forecast,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fit sin and cosin terms to data</span></span>
<span id="cb1-4">               trending,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fit and assess models</span></span>
<span id="cb1-5">               feasts,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for time series decomposition and autocorrelation</span></span>
<span id="cb1-6">               janitor,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary table </span></span>
<span id="cb1-7">               tidyverse        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data management and visualization</span></span>
<span id="cb1-8">               )</span></code></pre></div>
</div>
<p>Let’s create an object called <code>path</code> that will be the JSON link. For particularly large datasets, you probably will not be able to grab all rows with a single API call. An alternative is to request the data in batches by using the<code>$limit</code>and <code>$offset</code> parameters. Users can request data beginning at a row other than the first row by specifying the <code>?$offset=_" parameter</code> at the end of the URL. For example, for the COVID-19 Reported Patient Impact and Hospital Capacity by State Time Series dataset, <code>"https://healthdata.gov/resource/g62h-syeh.json?$limit=50000" will bring in the first 50000 rows"</code>, <code>"https://healthdata.gov/resource/g62h-syeh.json?$limit=50000&amp;\$offset=50000"</code> will bring in the next 50000 rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># url for first 50000 rows</span></span>
<span id="cb2-2">path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://healthdata.gov/resource/g62h-syeh.json?$limit=50000"</span> </span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># url for first 50000 rows</span></span>
<span id="cb2-5">path_2nd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://healthdata.gov/resource/g62h-syeh.json?$limit=50000&amp;$offset=50000"</span></span></code></pre></div>
</div>
<p>Now let’s make the request using GET() function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">request <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> path) </span>
<span id="cb3-2">request_2nd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">url =</span> path_2nd)</span></code></pre></div>
</div>
<section id="examining-the-get-output" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-get-output">Examining the GET() output</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># see the URL content</span></span>
<span id="cb4-2">request</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response [https://healthdata.gov/resource/g62h-syeh.json?$limit=50000]
  Date: 2024-07-26 11:06
  Status: 200
  Content-Type: application/json;charset=utf-8
  Size: 332 MB
[{"state":"MA","date":"2021-06-15T00:00:00.000","critical_staffing_shortage_t...
,{"state":"WY","date":"2021-06-13T00:00:00.000","critical_staffing_shortage_t...
,{"state":"LA","date":"2021-06-06T00:00:00.000","critical_staffing_shortage_t...
,{"state":"RI","date":"2021-06-04T00:00:00.000","critical_staffing_shortage_t...
,{"state":"KS","date":"2021-06-03T00:00:00.000","critical_staffing_shortage_t...
,{"state":"ME","date":"2021-06-03T00:00:00.000","critical_staffing_shortage_t...
,{"state":"RI","date":"2021-06-02T00:00:00.000","critical_staffing_shortage_t...
,{"state":"ME","date":"2021-05-30T00:00:00.000","critical_staffing_shortage_t...
,{"state":"RI","date":"2021-05-30T00:00:00.000","critical_staffing_shortage_t...
,{"state":"MS","date":"2021-05-28T00:00:00.000","critical_staffing_shortage_t...
...</code></pre>
</div>
</div>
<p>The output shows: <code>Date: 2024-07-02 22:49</code> when the request was made <code>Status: 200</code> refers to the success or failure of the API request, if the number is 200 the request was successful. <code>Content-Type: application/json</code> the response says that the data takes on json format <code>Size: 332 MB</code> the size of the json file</p>
</section>
<section id="converting-json-file-to-a-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="converting-json-file-to-a-data-frame">Converting JSON file to a data frame</h3>
<p>JSON is formatted as a series of key-value pairs, where particular word (“key”) is associated a particular value. to do this first let install jsonlite package that contain <code>fromJSON()</code> function that convert JSON file into <code>list</code>. The <code>fromJSON()</code> needs a character vector that contain the JSON structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the raw Unicode into a character vector that resembles the JSON format</span></span>
<span id="cb6-2">convert_JSON_to_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rawToChar</span>(request<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>content)</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the data we want in a format that we can more easily manipulate in R</span></span>
<span id="cb6-4">hospitalization_covid_usa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(convert_JSON_to_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flatten =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">######### convert the second file</span></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the raw Unicode into a character vector that resembles the JSON forma</span></span>
<span id="cb6-8">convert_JSON_to_df_2nd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rawToChar</span>(request_2nd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>content)</span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the data we want in a format that we can more easily manipulate in R</span></span>
<span id="cb6-10">hospitalization_covid_usa_2nd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(convert_JSON_to_df_2nd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flatten =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
<p>Let’s join the 2 tables using the <code>rbind()</code> function and clean the data. First I will clean the names of columns using the <code>clean_names()</code> function that standardizes the syntax of column names, and select interested variables. Use the <code>skim()</code> function for the summary table. I will select only 4 variables, <code>state</code>, <code>date</code>, <code>previous_day_admission_adult_covid_confirmed</code> and <code>previous_day_admission_pediatric_covid_confirmed</code>, the indicators are aligned to <a href="https://gateway.euro.who.int/en/indicators/hfa_534-6010-inpatient-care-discharges-per-100/#id=19629">WHO impatient care definition case</a>, then will sum give Hospitalization cases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># join data frame using rbind</span></span>
<span id="cb7-2">hosp_clean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(hospitalization_covid_usa, hospitalization_covid_usa_2nd) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replace</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate new hospitalization and deaths column</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">previous_day_admission_adult_covid_confirmed     =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(previous_day_admission_adult_covid_confirmed),</span>
<span id="cb7-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">previous_day_admission_pediatric_covid_confirmed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(previous_day_admission_pediatric_covid_confirmed),</span>
<span id="cb7-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_hospitalization =</span> previous_day_admission_adult_covid_confirmed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> previous_day_admission_pediatric_covid_confirmed,</span>
<span id="cb7-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">deaths_covid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(deaths_covid),</span>
<span id="cb7-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date                =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(date)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-11">  </span>
<span id="cb7-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select state, date and new_hospitalization variable</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(state, date, new_hospitalization, deaths_covid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-14">  </span>
<span id="cb7-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create new variable </span></span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country  =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UNITED STATES OF AMERICA"</span>,</span>
<span id="cb7-17">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ISO_3_CODE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"USA"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">tm_clean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hosp_clean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yearmonth =</span> zoo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.yearmon</span>(date)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(yearmonth) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_hospitalization =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(new_hospitalization, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb8-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">deaths_covid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(deaths_covid, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span></code></pre></div>
</div>
</section>
</section>
<section id="time-series-forecasting" class="level1">
<h1>Time Series Forecasting</h1>
<p>Is about predicting the future events or values using historical and present data points. <strong>Times Series:</strong> is anything that is observers sequentially over time, data points are gathered over time.</p>
<p>Predictor variables are often useful in time series forecasting. We have COVID-19 patient admission data in USA from <code>2020-01-01</code> to <code>2024-04-27</code>. In the next task we will continue of observations into the future using forecasting methods such as trend, seasonality and cyclic.</p>
<p>The basic step in a forecasting task is: - <strong>Problem definition:</strong> This requires an understanding of the way the forecasts will be used, who required the forecaster, and how the forecasting function fits within the requiring the forecasts - <strong>Gathering information:</strong> There are information required: statistical data and the accumulated expertise of people who collect the data and use the forecasts. - <strong>Preliminary (exploratory) analysis:</strong> Always start by graphing the data. Are there consistent patterns ? Is there a significant trend? Is seasonality important? various tools have been developed to help with this analysis. - <strong>Choosing and fitting models:</strong> The best model depends on the availability of historical data. - <strong>Using and evaluating a forecasting model:</strong> Once the model has been selected and its paremeters estimated, themodel is used to make forecasts.</p>
</section>
<section id="time-series-objects-in-r" class="level1">
<h1>Time series objects in R</h1>
<p>A time series can be throught of as vector or list of numbers. We store in a <code>ts</code> object, using <code>ts()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">tm<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts</span>(</span>
<span id="cb9-2">        tm_clean[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Just take the sequence of values into column </span></span>
<span id="cb9-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicate the time of the first observation, c(year, period)</span></span>
<span id="cb9-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frequency =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is set to 12 because data are montlhy</span></span></code></pre></div>
</div>
</section>
<section id="time-series-plots-trend" class="level1">
<h1>Time series plots “Trend”</h1>
<p>This graphs ebable to visualize many features of data, including patterns, unusual observations, changes over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># message: false</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(hosp_clean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>new_hospitalization)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2580</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(tm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">facets =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>   </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"COVID-19: New Hospitalization - Deaths"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Year"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000000</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast_files/figure-html/time_serie-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Time serie of New Hospitalization and Deaths</figcaption>
</figure>
</div>
</div>
</div>
<p>These time series, we have plotted, words such as “trend” and “seasonal” which need to be defined more carefully. -<strong>Trend:</strong> Exists when there is a long-term increase or decrease in the data. It does not have to be linear. -<strong>Seasonal:</strong>A seasonal pattern occurs when a time series is affected by seasonal factors such as the time of the year or the day of the week. Seasonality is always of a fixed and known frequency. -<strong>Cyclic:</strong> A cycle occurs when the data exhibit rises and falls that are not of a fixed frequency. These fluctuations are usually due to economic conditions, and are often related to the “business cycle”. The duration of these fluctuations is usually at least 2 years.</p>
<p>We will use two more function <code>which.max()</code> and <code>frequency()</code> that can be used to identify the smallest index of the maximun value</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">frequency</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
<section id="polar-seasonal-plot" class="level2">
<h2 class="anchored" data-anchor-id="polar-seasonal-plot">Polar Seasonal plot</h2>
<p>Is similar to a time plot except that the data are plotted against the individual “seasons” in which data were observed. will create using <code>ggseasonplot()</code> function</p>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># polar seasonal plot for hospitalization</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggseasonplot</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">polar =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Hospilatization"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Polar seasonal plot: New Hospitalization"</span>)</span>
<span id="cb17-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># polar seasonal plot for deaths</span></span>
<span id="cb17-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggseasonplot</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">polar =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Hospilatization"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Polar seasonal plot: Deaths"</span>)</span></code></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>-“hospitalization” -“deaths”</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>-“hospitalization” -“deaths”</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="autocorrelation-of-non-seasonal-time-series" class="level2">
<h2 class="anchored" data-anchor-id="autocorrelation-of-non-seasonal-time-series">Autocorrelation of non-seasonal time series</h2>
<p>Another way to look at time series data is to plot each observation against another observation that occurred some time previously by using <code>gglagplot()</code>. For example, you could plot <code>Yt</code> against <code>Yt−1</code>. This is called a lag plot because you are plotting the time series against lags of itself.</p>
<p>The correlations associated with the lag plots form what is called the autocorrelation function (ACF). The <code>ggAcf()</code> function produces ACF plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ACF plot of hospitalization data</span></span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggAcf</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>###White noise</p>
<ul>
<li>iid, or random, independent, individually distributed observations</li>
</ul>
<p>###Ljung-Box Test</p>
<p>The Llung-Box test considers the first h autocorrelation values together</p>
<p>A significant test (small p-value) indicates the data are probably not white noise.</p>
<p>###White noise summary</p>
<ul>
<li>white noise is a time series that is purely random</li>
<li>we can test for white noise by looking at an ACF plot or by doing a Ljung-Box test</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Box.test</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lag =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fitdf =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ljung"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Ljung test

data:  tm[, 1]
X-squared = 77.144, df = 24, p-value = 1.723e-07</code></pre>
</div>
</div>
</section>
</section>
<section id="difference-series" class="level1">
<h1>Difference series</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(forecast<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">naive</span>(tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Forecast method: Naive method

Model Information:
Call: forecast::naive(y = tm[, 1], h = 20) 

Residual sd: 98496.2732 

Error measures:
                   ME     RMSE      MAE  MPE MAPE      MASE       ACF1
Training set 463.0588 98496.27 59888.31 -Inf  Inf 0.5476191 0.09158876

Forecasts:
         Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95
May 2024          24276 -101952.1 150504.1 -168773.1 217325.1
Jun 2024          24276 -154237.4 202789.4 -248736.7 297288.7
Jul 2024          24276 -194357.4 242909.4 -310094.9 358646.9
Aug 2024          24276 -228180.1 276732.1 -361822.3 410374.3
Sep 2024          24276 -257978.5 306530.5 -407395.0 455947.0
Oct 2024          24276 -284918.3 333470.3 -448595.9 497147.9
Nov 2024          24276 -309692.0 358244.0 -486484.0 535036.0
Dec 2024          24276 -332750.8 381302.8 -521749.4 570301.4
Jan 2025          24276 -354408.2 402960.2 -554871.4 603423.4
Feb 2025          24276 -374892.2 423444.2 -586199.0 634751.0
Mar 2025          24276 -394375.1 442927.1 -615995.6 664547.6
Apr 2025          24276 -412990.8 461542.8 -644465.9 693017.9
May 2025          24276 -430845.7 479397.7 -671772.6 720324.6
Jun 2025          24276 -448026.1 496578.1 -698047.8 746599.8
Jul 2025          24276 -464603.1 513155.1 -723400.1 771952.1
Aug 2025          24276 -480636.2 529188.2 -747920.6 796472.6
Sep 2025          24276 -496175.6 544727.6 -771686.0 820238.0
Oct 2025          24276 -511264.3 559816.3 -794762.2 843314.2
Nov 2025          24276 -525939.3 574491.3 -817205.7 865757.7
Dec 2025          24276 -540233.0 588785.0 -839066.0 887618.0</code></pre>
</div>
</div>
<section id="checking-time-series-residuals" class="level2">
<h2 class="anchored" data-anchor-id="checking-time-series-residuals">Checking time series residuals</h2>
<p>When applying a forecasting method, it is important to always check that the residual are well-behaved and resemble white noise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">naive</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">checkresiduals</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Naive method
Q* = 22.085, df = 10, p-value = 0.01468

Model df: 0.   Total lags used: 10</code></pre>
</div>
</div>
</section>
</section>
<section id="forecasting-with-arima-models" class="level1">
<h1>Forecasting with ARIMA models</h1>
<p>ARIMA models aim to describe the autocorrelations in the data, use the <code>Arima()</code> function in R. There is another function <code>arima()</code> in T which also fits an ARIMA model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">tm[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Arima</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include.constant =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">forecast</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>



</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div> ]]></description>
  <category>R</category>
  <category>API</category>
  <category>Forecast</category>
  <category>ARIMA model</category>
  <category>Time series</category>
  <category>Hospitalization</category>
  <category>COVID-19</category>
  <guid>https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast.html</guid>
  <pubDate>Tue, 02 Jul 2024 22:00:00 GMT</pubDate>
  <media:content url="https://bejewelled-nougat-3b99a7.netlify.app/posts/forecast_hosp/forecast.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Automated Surveillance Report using R Quarto</title>
  <dc:creator>João Muianga</dc:creator>
  <link>https://bejewelled-nougat-3b99a7.netlify.app/posts/auto_report/auto_report.html</link>
  <description><![CDATA[ 




<section id="load-packages" class="level1">
<h1>Load Packages</h1>
<p>We will load janitor for data cleaning, <a href="https://tidyr.tidyverse.org">tidyverse</a> for data management and visualization, <a href="https://r4epi.github.io/epikit/">epikit</a>, <a href="https://r4epi.github.io/apyramid/">apyramid</a>, to import data, cleaning, create plot and table presentation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This chunk loads packages</span></span>
<span id="cb1-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-3">     rio,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for importing data</span></span>
<span id="cb1-4">     here,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for locating files</span></span>
<span id="cb1-5">     skimr,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reviewing the data</span></span>
<span id="cb1-6">     janitor,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for data cleaning  </span></span>
<span id="cb1-7">     epikit,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creating age categories</span></span>
<span id="cb1-8">     gtsummary,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creating tables  </span></span>
<span id="cb1-9">     RColorBrewer, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for colour palettes</span></span>
<span id="cb1-10">     viridis,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for more colour palettes</span></span>
<span id="cb1-11">     scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># percents in tables  </span></span>
<span id="cb1-12">     flextable,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for making pretty tables</span></span>
<span id="cb1-13">     gghighlight,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># highlighting plot parts  </span></span>
<span id="cb1-14">     ggExtra,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># special plotting functions</span></span>
<span id="cb1-15">     matchmaker, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dictionary-based cleaning</span></span>
<span id="cb1-16">     tsibble,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for epiweek </span></span>
<span id="cb1-17">     forcats,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Missing values</span></span>
<span id="cb1-18">     scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># works with date</span></span>
<span id="cb1-19">     apyramid,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># age pyramid</span></span>
<span id="cb1-20">     rstatix,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary statistic</span></span>
<span id="cb1-21">     ggExtra,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># special plotting functions</span></span>
<span id="cb1-22">     tidyverse     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for data management and visualization</span></span>
<span id="cb1-23">     </span>
<span id="cb1-24">)</span></code></pre></div>
</div>
</section>
<section id="import-dataset" class="level1">
<h1>Import dataset</h1>
<p>This is a fake data of fever outbreak in Mali 2020.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This chunck import the linelist of yellow fever</span></span>
<span id="cb2-2">yellow_fever_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yelow_fever_ mali_09_01_2020.xlsx"</span>))</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">skimr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skim</span>(yellow_fever_raw)</span></code></pre></div>
</details>
</div>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">yellow_fever_clean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> yellow_fever_raw<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># automatically clean column name</span></span>
<span id="cb4-3">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-4">  </span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># manually clean column names to English</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb4-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#new            #old</span></span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_order =</span>num_ordre,</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_month =</span> age_mois,</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_year =</span> age_an,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> sexe,</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">health_area =</span> aire_de_sante,</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district_not =</span> district_sanitaire_notifiant,</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district_res =</span> district_sanitaire_de_residence,</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_onset =</span> date_de_consultation,</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fever =</span> fievre,</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">symptoms =</span> symptomes,</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_death =</span> date_de_deces,</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">classification =</span> classification_finale,</span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> evolution</span>
<span id="cb4-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-22"></span>
<span id="cb4-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># de-duplicate rows</span></span>
<span id="cb4-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-25">  </span>
<span id="cb4-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#convert date onset to date class</span></span>
<span id="cb4-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_onset =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymd</span>(date_onset)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-28">  </span>
<span id="cb4-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert age (month and year) to numeric class</span></span>
<span id="cb4-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_month =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(age_month),</span>
<span id="cb4-31">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(age_year)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-32">  </span>
<span id="cb4-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert "Unknown" gender to NA</span></span>
<span id="cb4-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na_if</span>(gender, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unknown"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-35">  </span>
<span id="cb4-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create column epiweek </span></span>
<span id="cb4-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">epiweek =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor_date</span>(date_onset, </span>
<span id="cb4-38">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"week"</span>,</span>
<span id="cb4-39">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">week_start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-40">                              )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-41">  </span>
<span id="cb4-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># properly record missing values in many character columns</span></span>
<span id="cb4-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.character), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fns =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na_if</span>(.x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-44">  </span>
<span id="cb4-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># re-code status columns</span></span>
<span id="cb4-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(status,</span>
<span id="cb4-47">          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reference: OLD  = NEW                 </span></span>
<span id="cb4-48">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Confirmé"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confirmed"</span>,</span>
<span id="cb4-49">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probable"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probable"</span>,</span>
<span id="cb4-50">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Suspect"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"suspected"</span> ))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-51">  </span>
<span id="cb4-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># re-code outcome columns</span></span>
<span id="cb4-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(outcome,</span>
<span id="cb4-54">          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reference: OLD  = NEW                 </span></span>
<span id="cb4-55">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vivant"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alive"</span>,</span>
<span id="cb4-56">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Décédé"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dead"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-57">  </span>
<span id="cb4-58">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># re-code classification columns</span></span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">classification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(classification,</span>
<span id="cb4-60">          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reference: OLD  = NEW                 </span></span>
<span id="cb4-61">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Confirme"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confirmed"</span>,</span>
<span id="cb4-62">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probable"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probable"</span>,</span>
<span id="cb4-63">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Non cas"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no_case"</span>,</span>
<span id="cb4-64">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Suspect"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"suspected"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-65">  </span>
<span id="cb4-66">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># re-code some names in symptoms columns</span></span>
<span id="cb4-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">symptoms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(symptoms,</span>
<span id="cb4-68">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reference: OLD  = NEW   </span></span>
<span id="cb4-69">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fièvre, ictère,"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fièvre, ictère"</span>,</span>
<span id="cb4-70">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fievre plus ictere"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fièvre, ictère"</span>,</span>
<span id="cb4-71">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Icteère, fièvre, vomissement"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ictère, fivre, Vomissement"</span>,</span>
<span id="cb4-72">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fièvre, ictère, vomissement"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ictère, fivre, Vomissement"</span>,</span>
<span id="cb4-73">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fièvre,Fièvre, Vomissemnt"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fièvre, Vomissemnt"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-74"></span>
<span id="cb4-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create column age_years</span></span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_years =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb4-77">    age_year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(age_year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age_year,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if column is age_year keep age_year</span></span>
<span id="cb4-78">    age_month <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(age_month) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age_month<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if column age_month is month divide by 12 </span></span>
<span id="cb4-79">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>                                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if age_year missing assume age_years, else NA</span></span>
<span id="cb4-80">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-81">  </span>
<span id="cb4-82">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># transform to numeric</span></span>
<span id="cb4-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_years =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(age_years)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-84"></span>
<span id="cb4-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># age_class column</span></span>
<span id="cb4-86"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(age_years <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adult"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"child"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-87">  </span>
<span id="cb4-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create age categories column</span></span>
<span id="cb4-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span> (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_cat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(</span>
<span id="cb4-90">    age_years,</span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>( <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> , <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),          </span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include.lowest =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5-14"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"15-24"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+25"</span>)),</span>
<span id="cb4-95">    </span>
<span id="cb4-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_cat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_explicit_na</span>(</span>
<span id="cb4-97">      age_cat,</span>
<span id="cb4-98">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na_level =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Missing age"</span></span>
<span id="cb4-99">    )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-100">  </span>
<span id="cb4-101"></span>
<span id="cb4-102"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check similar column in district_res and district_dect</span></span>
<span id="cb4-103"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">moved =</span> district_res <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> district_not)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-104">  </span>
<span id="cb4-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create new column named district to fill-in missing values</span></span>
<span id="cb4-106"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coalesce</span>(district_not, district_res)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-107">  </span>
<span id="cb4-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># re-code districts columns</span></span>
<span id="cb4-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(district,</span>
<span id="cb4-110">          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reference: OLD  = NEW                 </span></span>
<span id="cb4-111">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ouelessebougou"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ouélessebougou"</span>,</span>
<span id="cb4-112">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sefeto"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sofeto"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-113">  </span>
<span id="cb4-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select column in study</span></span>
<span id="cb4-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(n_order, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"district"</span>), date_onset, epiweek, age_cat, age_years, gender, status, classification, outcome, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>())</span></code></pre></div>
</div>
</section>
<section id="highlights-for-introduction" class="level1">
<h1>Highlights for Introduction</h1>
<ul>
<li>48 Number of new cases reported during the epi-week <span style="color: green;"><strong>2019-12-30 - N°4</strong></span> including 5 confirmed cases and 7 deaths.</li>
<li>48 <em>Cumulative number of cases since the beginning of the outbreaks including</em> 5 confirmed cases, 3 probable cases and 40 suspected cases.</li>
<li>7 <em>Cumulative number of deaths</em>, providing a case fatality rate of 15%.</li>
</ul>
<p>This is the code <code>inline</code> that create the Highlights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#-   `r nrow(yellow_fever_clean)` Number of new cases reported during the epi-week [ **`r max(yellow_fever_clean$epiweek)` - N°4**]{style="color: green;"} including `r sum(yellow_fever_clean$status == "confirmed", na.rm = T)` confirmed cases and `r sum(yellow_fever_clean$outcome == "dead", na.rm = T)` deaths.</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#-   `r nrow(yellow_fever_clean)` *Cumulative number of cases since the beginning of the outbreaks including* `r sum(yellow_fever_clean$status == "confirmed", na.rm = T)` confirmed cases, `r sum(yellow_fever_clean$status == "probable", na.rm = T)` probable cases and `r sum(yellow_fever_clean$status == "suspected", na.rm = T)` suspected cases.</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#-   `r sum(yellow_fever_clean$outcome == "dead", na.rm = T)` *Cumulative number of deaths*, providing a case fatality rate of `r  round(sum(yellow_fever_clean$outcome == "dead", na.rm = T)/nrow(yellow_fever_clean)*100, digits=0)`%.</span></span></code></pre></div>
</div>
</section>
<section id="summary-table" class="level1">
<h1>Summary Table</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">border_style <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> officer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fp_border</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Table summarizing the number of cases (confirmed, probable, and suspected) by District sanitaire: Cumulative and last epi-week</span></span>
<span id="cb6-4">yellow_fever_clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(district) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb6-7">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cum_cases =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb6-8">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case_1wk =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(cum_cases[epiweek <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(epiweek)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb6-9">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suspected =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"suspected"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T),</span>
<span id="cb6-10">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">confirmed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confirmed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T),</span>
<span id="cb6-11">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probable =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probable"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(cum_cases <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_totals</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">where =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"col"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_percentages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"col"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_pct_formatting</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_ns</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"front"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qflextable</span>()  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_header_labels</span>(</span>
<span id="cb6-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"District"</span>,</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cum_cases =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cumulative Cases"</span>,</span>
<span id="cb6-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case_1wk =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cases - Last Week"</span>,</span>
<span id="cb6-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suspected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Supected cases "</span>,</span>
<span id="cb6-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">confirmed =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Confirmed cases "</span>,</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probable =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probable cases "</span></span>
<span id="cb6-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-26">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">j =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> border_style)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-27">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bg</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray95"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-28">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bg</span>(., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i=</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> district <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bougouni"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#91c293"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-4cde484e{}.cl-4cda9686{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4cdc5980{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4cdc638a{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc638b{width:1.058in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc638c{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc6394{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc6395{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc6396{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc639e{width:1.44in;background-color:rgba(145, 194, 147, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc639f{width:1.058in;background-color:rgba(145, 194, 147, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63a8{width:0.965in;background-color:rgba(145, 194, 147, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63a9{width:1.033in;background-color:rgba(145, 194, 147, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63b2{width:1.033in;background-color:rgba(145, 194, 147, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63b3{width:1.033in;background-color:rgba(145, 194, 147, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63b4{width:1.44in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63bc{width:1.058in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63bd{width:0.965in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63be{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63bf{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63c6{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63c7{width:1.44in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63c8{width:1.058in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63d0{width:0.965in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63d1{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63da{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63db{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63dc{width:1.44in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63dd{width:1.058in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63de{width:0.965in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63e4{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63e5{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4cdc63e6{width:1.033in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-4cde484e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-4cdc638a"><p class="cl-4cdc5980"><span class="cl-4cda9686">District</span></p></th><th class="cl-4cdc638b"><p class="cl-4cdc5980"><span class="cl-4cda9686">Cumulative Cases</span></p></th><th class="cl-4cdc638c"><p class="cl-4cdc5980"><span class="cl-4cda9686">Cases - Last Week</span></p></th><th class="cl-4cdc6394"><p class="cl-4cdc5980"><span class="cl-4cda9686">Supected cases </span></p></th><th class="cl-4cdc6394"><p class="cl-4cdc5980"><span class="cl-4cda9686">Confirmed cases </span></p></th><th class="cl-4cdc6395"><p class="cl-4cdc5980"><span class="cl-4cda9686">Probable cases </span></p></th><th class="cl-4cdc6396"><p class="cl-4cdc5980"><span class="cl-4cda9686">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-4cdc639e"><p class="cl-4cdc5980"><span class="cl-4cda9686">Bougouni</span></p></td><td class="cl-4cdc639f"><p class="cl-4cdc5980"><span class="cl-4cda9686">21 (55.3%)</span></p></td><td class="cl-4cdc63a8"><p class="cl-4cdc5980"><span class="cl-4cda9686">0  (0.0%)</span></p></td><td class="cl-4cdc63a9"><p class="cl-4cdc5980"><span class="cl-4cda9686">15 (46.9%)</span></p></td><td class="cl-4cdc63a9"><p class="cl-4cdc5980"><span class="cl-4cda9686">3 (100.0%)</span></p></td><td class="cl-4cdc63b2"><p class="cl-4cdc5980"><span class="cl-4cda9686">3 (100.0%)</span></p></td><td class="cl-4cdc63b3"><p class="cl-4cdc5980"><span class="cl-4cda9686">42 (48.8%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4cdc63b4"><p class="cl-4cdc5980"><span class="cl-4cda9686">Commune V</span></p></td><td class="cl-4cdc63bc"><p class="cl-4cdc5980"><span class="cl-4cda9686">3  (7.9%)</span></p></td><td class="cl-4cdc63bd"><p class="cl-4cdc5980"><span class="cl-4cda9686">3 (30.0%)</span></p></td><td class="cl-4cdc63be"><p class="cl-4cdc5980"><span class="cl-4cda9686">3  (9.4%)</span></p></td><td class="cl-4cdc63be"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63bf"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63c6"><p class="cl-4cdc5980"><span class="cl-4cda9686">9 (10.5%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4cdc63b4"><p class="cl-4cdc5980"><span class="cl-4cda9686">Kalaban coro</span></p></td><td class="cl-4cdc63bc"><p class="cl-4cdc5980"><span class="cl-4cda9686">2  (5.3%)</span></p></td><td class="cl-4cdc63bd"><p class="cl-4cdc5980"><span class="cl-4cda9686">0  (0.0%)</span></p></td><td class="cl-4cdc63be"><p class="cl-4cdc5980"><span class="cl-4cda9686">2  (6.2%)</span></p></td><td class="cl-4cdc63be"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63bf"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63c6"><p class="cl-4cdc5980"><span class="cl-4cda9686">4  (4.7%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4cdc63c7"><p class="cl-4cdc5980"><span class="cl-4cda9686">Ouélessebougou</span></p></td><td class="cl-4cdc63c8"><p class="cl-4cdc5980"><span class="cl-4cda9686">5 (13.2%)</span></p></td><td class="cl-4cdc63d0"><p class="cl-4cdc5980"><span class="cl-4cda9686">0  (0.0%)</span></p></td><td class="cl-4cdc63d1"><p class="cl-4cdc5980"><span class="cl-4cda9686">5 (15.6%)</span></p></td><td class="cl-4cdc63d1"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63da"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63db"><p class="cl-4cdc5980"><span class="cl-4cda9686">10 (11.6%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4cdc63b4"><p class="cl-4cdc5980"><span class="cl-4cda9686">Sofeto</span></p></td><td class="cl-4cdc63bc"><p class="cl-4cdc5980"><span class="cl-4cda9686">3  (7.9%)</span></p></td><td class="cl-4cdc63bd"><p class="cl-4cdc5980"><span class="cl-4cda9686">3 (30.0%)</span></p></td><td class="cl-4cdc63be"><p class="cl-4cdc5980"><span class="cl-4cda9686">3  (9.4%)</span></p></td><td class="cl-4cdc63be"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63bf"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63c6"><p class="cl-4cdc5980"><span class="cl-4cda9686">9 (10.5%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4cdc63dc"><p class="cl-4cdc5980"><span class="cl-4cda9686">Tombouctou</span></p></td><td class="cl-4cdc63dd"><p class="cl-4cdc5980"><span class="cl-4cda9686">4 (10.5%)</span></p></td><td class="cl-4cdc63de"><p class="cl-4cdc5980"><span class="cl-4cda9686">4 (40.0%)</span></p></td><td class="cl-4cdc63e4"><p class="cl-4cdc5980"><span class="cl-4cda9686">4 (12.5%)</span></p></td><td class="cl-4cdc63e4"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63e5"><p class="cl-4cdc5980"><span class="cl-4cda9686">0   (0.0%)</span></p></td><td class="cl-4cdc63e6"><p class="cl-4cdc5980"><span class="cl-4cda9686">12 (14.0%)</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="cases-by-classification-by-outcome" class="level1">
<h1>Cases by classification by outcome</h1>
<p>Plot the Distribution of cases by classification and by outcome using geom_bar() function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> yellow_fever_clean, </span>
<span id="cb7-2">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> classification,</span>
<span id="cb7-3">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>outcome)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alive"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1c9099"</span>,</span>
<span id="cb7-7">                              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dead"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#c51b8a"</span>),</span>
<span id="cb7-8">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alive"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alive"</span>,</span>
<span id="cb7-9">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dead"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead"</span>) )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classification"</span>,</span>
<span id="cb7-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number"</span>,</span>
<span id="cb7-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outcome"</span></span>
<span id="cb7-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb7-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>),</span>
<span id="cb7-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb7-19">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/auto_report/auto_report_files/figure-html/geom_bar-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="epicurve-of-symptoms-and-classification" class="level1">
<h1>Epicurve of symptoms and classification</h1>
<p>Plot a epicurve showing distribution of cases by week of symptoms onset and classification.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> yellow_fever_clean, </span>
<span id="cb8-2">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> epiweek)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-3"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> classification)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_date</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 month"</span>,</span>
<span id="cb8-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_labels =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%d %b </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> %Y"</span>, </span>
<span id="cb8-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb8-8">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confirmed"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#2b8cbe"</span>, </span>
<span id="cb8-9">                                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probable"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>,</span>
<span id="cb8-10">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"suspected"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d95f0e"</span>),</span>
<span id="cb8-11">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confirmed"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Confirmed"</span>,</span>
<span id="cb8-12">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probable"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probable"</span>,</span>
<span id="cb8-13">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"suspected"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Suspected"</span>),</span>
<span id="cb8-14">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classification"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>district) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epi- week"</span>,</span>
<span id="cb8-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cases"</span>,</span>
<span id="cb8-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classification"</span>,</span>
<span id="cb8-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A total of {n_distinct(yellow_fever_clean$district)} districts reported  Yellow fever cases </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Cumulative cases of {nrow(yellow_fever_clean)} as of {max(yellow_fever_clean$epiweek)}"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/auto_report/auto_report_files/figure-html/epicurve-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="age-pyramid" class="level1">
<h1>Age Pyramid</h1>
<p>Plot the distribution of cases by age group and gender using <a href="https://r4epi.github.io/apyramid/">apyramid</a> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">apyramid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">age_pyramid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> yellow_fever_clean,</span>
<span id="cb9-2">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_group =</span> age_cat,</span>
<span id="cb9-3">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">split_by =</span> gender,</span>
<span id="cb9-4">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_midpoint =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>,</span>
<span id="cb9-6">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>),</span>
<span id="cb9-7">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>,</span>
<span id="cb9-8">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Female"</span>),</span>
<span id="cb9-9">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age Pyramid"</span>,</span>
<span id="cb9-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cases"</span>,</span>
<span id="cb9-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age Category"</span>,</span>
<span id="cb9-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gender"</span>,</span>
<span id="cb9-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total cases (%):  in Male {fmt_count(yellow_fever_clean, gender == 'M')} and Female {fmt_count(yellow_fever_clean, gender == 'F')}"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb9-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb9-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb9-19">    </span>
<span id="cb9-20">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://bejewelled-nougat-3b99a7.netlify.app/posts/auto_report/auto_report_files/figure-html/age_pyramid-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>



</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div> ]]></description>
  <category>R</category>
  <category>Visualization</category>
  <category>ggplot2</category>
  <category>Summary Table</category>
  <guid>https://bejewelled-nougat-3b99a7.netlify.app/posts/auto_report/auto_report.html</guid>
  <pubDate>Sat, 29 Jun 2024 22:00:00 GMT</pubDate>
  <media:content url="https://bejewelled-nougat-3b99a7.netlify.app/posts/auto_report/auto.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>API with R to Extract data from the WHO Global Health Observatory (GHO)</title>
  <dc:creator>João Muianga</dc:creator>
  <link>https://bejewelled-nougat-3b99a7.netlify.app/posts/gho_with_api/post.html</link>
  <description><![CDATA[ 




<section id="context-purpose" class="level1">
<h1>Context / Purpose</h1>
<p><a href="https://www.who.int/data/gho">The Global Health Observatory (GHO)</a> data repository is WHO’s gateway to health-related statistics. It provides access to over 1000 indicators on priority health topics including mortality and burden of diseases, the Millenium Development Goals and more. They are updated as more recent or revised data become available.</p>
<p>In this scenario I will create a function to extract the indicator of <em>Nutrition - Prevalence of wasted children under 5 years of age</em> and summarise a table showing the total of countries by region that have their most recent value from the year of 2001 to 2020.</p>
</section>
<section id="install-packages" class="level1">
<h1>Install packages</h1>
<p>Install and run packages, they are the fundamental units of reproducible R code. In this case we will run packages for external connections and reproduction of summarized tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  rio,              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import and export files</span></span>
<span id="cb1-3">  here,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File pathways</span></span>
<span id="cb1-4">  jsonlite,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read JSON file in R</span></span>
<span id="cb1-5">  httr,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Request object in URL or HTML (GET(), POST())</span></span>
<span id="cb1-6">  glue,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Interpret string literals that are small, fast, and dependency-free</span></span>
<span id="cb1-7">  janitor,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data cleaning and tables</span></span>
<span id="cb1-8">  lubridate,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Working with dates</span></span>
<span id="cb1-9">  flextable,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mMke HTML tables </span></span>
<span id="cb1-10">  officer,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hHlper functions for tables</span></span>
<span id="cb1-11">  tidyverse         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data management and visualization</span></span>
<span id="cb1-12">)</span></code></pre></div>
</div>
</section>
<section id="function-to-extract-data-in-the-gho-odata-api" class="level1">
<h1>Function to extract data in the GHO OData API</h1>
<ul>
<li><p>First let’s define the global variables, this involves setting the URL, and indicators interested. The Indicator code is: <em>Prevalence of wasted children under 5 years of age</em>.</p></li>
<li><p>Second, we will create a function that requests and searches the data on the GHO website for R and converts JSON files into a data frame.</p></li>
</ul>
<p>Code source: Thanks <a href="https://medium.com/@kirstin.lyon/connect-to-global-health-observatory-who-data-api-with-r-fef4315693a1">Kirstin</a> for useful tutorial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global variable</span></span>
<span id="cb2-2">url_base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://ghoapi.azureedge.net/api/"</span> </span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Declare the type of indicators </span></span>
<span id="cb2-5">indicator_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prevalence"</span>      </span>
<span id="cb2-6">indicator_text_wasted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wasting prevalence among children under 5 years of age"</span></span>
<span id="cb2-7">indicator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NUTRITION_WH_2"</span></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The function convert a JSON in URL to tibble</span></span>
<span id="cb2-10">convert_JSON_to_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(url){</span>
<span id="cb2-11">  data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(url)                                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get a url</span></span>
<span id="cb2-12">  data_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">as =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">encoding =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"utf-8"</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert R object to JSON</span></span>
<span id="cb2-13">  data_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_if</span>(data_df, is.data.frame, list) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Takes a predicate function.p </span></span>
<span id="cb2-14">    as_tibble <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>                                                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Turn the object such as a data frame</span></span>
<span id="cb2-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>                                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expands a list-column containing dataframe into rows and columns</span></span>
<span id="cb2-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'@odata.context'</span>)                                         </span>
<span id="cb2-17">}</span>
<span id="cb2-18"></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">###### Exploring the data</span></span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># URL will provide you with the list of indicators</span></span>
<span id="cb2-23">all_indicators <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convert_JSON_to_tbl</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(url_base,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Indicator"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Language)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">####### Create a vector for the  indicator requested</span></span>
<span id="cb2-27"></span>
<span id="cb2-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the indicator through code</span></span>
<span id="cb2-29">get_indicator_code <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_indicators <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(indicator, IndicatorCode, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignore.case =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># grepl search for matches to argument pattern</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the indicator through text </span></span>
<span id="cb2-33">get_indicator_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_indicators <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(indicator_text, IndicatorName, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignore.case =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb2-35"></span>
<span id="cb2-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the indicator through a word "Wasting" </span></span>
<span id="cb2-37">get_indicator_text_wasted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_indicators <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(indicator_text_wasted, IndicatorName, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignore.case =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb2-39"></span>
<span id="cb2-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join the tables </span></span>
<span id="cb2-41">indicators <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> get_indicator_code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">union</span>(get_indicator_text) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">union</span>(get_indicator_text_wasted)</span>
<span id="cb2-44"></span>
<span id="cb2-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show in a list the names of indicator codes</span></span>
<span id="cb2-46">indicator_codes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> get_indicator_code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(IndicatorCode)</span>
<span id="cb2-48"></span>
<span id="cb2-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pull data and Convert to a List, however only extract data of interest</span></span>
<span id="cb2-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Each indicator has its own table in the WHO GHO, but in this case we would like to have one table "Nutrition_WH"</span></span>
<span id="cb2-51">indicator_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(indicator_codes, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(code){       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># return a list   </span></span>
<span id="cb2-52">  response <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(</span>
<span id="cb2-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(url_base, code))                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get URL and the 2 indicators codes found</span></span>
<span id="cb2-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(response, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>)</span>
<span id="cb2-55">})</span>
<span id="cb2-56"></span>
<span id="cb2-57"></span>
<span id="cb2-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Converts the list to tibble with one column per field</span></span>
<span id="cb2-59">indicator_data_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(indicator_data, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(.x, </span>
<span id="cb2-60">                                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplifyVector =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-61">                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-62">                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>())) </span>
<span id="cb2-63"></span>
<span id="cb2-64"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">export</span>(indicator_data_tbl, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_table_raw.csv"</span>))</span></code></pre></div>
</div>
</section>
<section id="check-the-data" class="level1">
<h1>Check the data</h1>
<p>It’s always good to check the table, use the <code>skimr::skim(dataset)</code> function it provides summary statistics about variables in data frames, however let see only 5 rows and all columns.</p>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<p>Time to clean the data_table. let’s use the functions from the tidyverse family of R packages, we just need to rename interested columns using the <code>rename()</code> function and reorder the columns, keeping the original ones at the end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">data_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> indicator_data_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean column names</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename columns </span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> time_dim,</span>
<span id="cb3-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numeric_value =</span> numeric_value,</span>
<span id="cb3-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high_value =</span> high,</span>
<span id="cb3-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low_value =</span> low,</span>
<span id="cb3-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_code =</span> spatial_dim,</span>
<span id="cb3-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region_code =</span> parent_location_code,</span>
<span id="cb3-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region_name =</span> parent_location,</span>
<span id="cb3-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indicator_code =</span> id,</span>
<span id="cb3-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indicator_name =</span> indicator_code,</span>
<span id="cb3-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">source =</span> odata_context) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reorder the position of interest's columns</span></span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(indicator_code, indicator_name, region_code, region_name, year, country_code, low_value, high_value, numeric_value, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>())</span></code></pre></div>
</div>
</section>
<section id="summary-table" class="level1">
<h1>Summary Table</h1>
<p>Let’s create a nice table to show how many countries have their most recent value in the year ranges 2001-2005, 2006-2010, 2011-2015, 2016-2020.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">data_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nutrition_dataset.csv"</span>))</span>
<span id="cb4-2"></span>
<span id="cb4-3">border_style <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> officer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fp_border</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-4"></span>
<span id="cb4-5"> data_table <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, value<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb4-8">    year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2006</span>  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2001-2005"</span>,</span>
<span id="cb4-9">    year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2011</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2006-2010"</span>,</span>
<span id="cb4-10">    year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2010</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2016</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2011-2015"</span>,</span>
<span id="cb4-11">    year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2016-2020"</span></span>
<span id="cb4-12">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(range, region_name, country_code, value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-14">   </span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(range, country_code, region_name)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tabyl</span>(region_name, range, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_na =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_totals</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_percentages</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">denominator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"col"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_pct_formatting</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adorn_ns</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"front"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-21">  flextable<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qflextable</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autofit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-23">    </span>
<span id="cb4-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_header_row</span>(</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WHO Region"</span>,</span>
<span id="cb4-27">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total of Countries by Year Range"</span>,</span>
<span id="cb4-28">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb4-29">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb4-30">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_header_labels</span>(</span>
<span id="cb4-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region_name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge_at</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">j=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"header"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">border_remove</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_booktabs</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">j=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> border_style)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">align</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">j =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fontsize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"header"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bold</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"header"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bold</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">i =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bold =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bg</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">part =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray95"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-9be9cf48{}.cl-9be69f1c{font-family:'Helvetica';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9be69f26{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9be69f30{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9be7e804{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9be7e805{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9be7f2b8{width:1.839in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2b9{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2c2{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2c3{width:1.839in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2c4{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2c5{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2cc{width:1.839in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2cd{width:1.117in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2ce{width:1.202in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2cf{width:1.839in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2d6{width:1.117in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9be7f2d7{width:1.202in;background-color:rgba(242, 242, 242, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-9be9cf48"><thead><tr style="overflow-wrap:break-word;"><th class="cl-9be7f2b8"><p class="cl-9be7e804"><span class="cl-9be69f1c">WHO Region</span></p></th><th colspan="4" class="cl-9be7f2b9"><p class="cl-9be7e805"><span class="cl-9be69f1c">Total of Countries by Year Range</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-9be7f2c3"><p class="cl-9be7e804"><span class="cl-9be69f26"></span></p></th><th class="cl-9be7f2c4"><p class="cl-9be7e805"><span class="cl-9be69f26">2001-2005</span></p></th><th class="cl-9be7f2c5"><p class="cl-9be7e805"><span class="cl-9be69f26">2006-2010</span></p></th><th class="cl-9be7f2c5"><p class="cl-9be7e805"><span class="cl-9be69f26">2011-2015</span></p></th><th class="cl-9be7f2c5"><p class="cl-9be7e805"><span class="cl-9be69f26">2016-2020</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9be7f2cc"><p class="cl-9be7e804"><span class="cl-9be69f26">Africa</span></p></td><td class="cl-9be7f2cd"><p class="cl-9be7e805"><span class="cl-9be69f26">25  (28.1%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">35  (31.5%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">41  (36.3%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">35  (34.3%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9be7f2cc"><p class="cl-9be7e804"><span class="cl-9be69f26">Americas</span></p></td><td class="cl-9be7f2cd"><p class="cl-9be7e805"><span class="cl-9be69f26">18  (20.2%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">22  (19.8%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">20  (17.7%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">19  (18.6%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9be7f2cc"><p class="cl-9be7e804"><span class="cl-9be69f26">Eastern Mediterranean</span></p></td><td class="cl-9be7f2cd"><p class="cl-9be7e805"><span class="cl-9be69f26">13  (14.6%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">12  (10.8%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">15  (13.3%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">12  (11.8%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9be7f2cc"><p class="cl-9be7e804"><span class="cl-9be69f26">Europe</span></p></td><td class="cl-9be7f2cd"><p class="cl-9be7e805"><span class="cl-9be69f26">18  (20.2%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">15  (13.5%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">16  (14.2%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">14  (13.7%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9be7f2cc"><p class="cl-9be7e804"><span class="cl-9be69f26">South-East Asia</span></p></td><td class="cl-9be7f2cd"><p class="cl-9be7e805"><span class="cl-9be69f26">7   (7.9%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">11   (9.9%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">8   (7.1%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">10   (9.8%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9be7f2cc"><p class="cl-9be7e804"><span class="cl-9be69f26">Western Pacific</span></p></td><td class="cl-9be7f2cd"><p class="cl-9be7e805"><span class="cl-9be69f26">8   (9.0%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">16  (14.4%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">13  (11.5%)</span></p></td><td class="cl-9be7f2ce"><p class="cl-9be7e805"><span class="cl-9be69f26">12  (11.8%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9be7f2cf"><p class="cl-9be7e804"><span class="cl-9be69f30">Total</span></p></td><td class="cl-9be7f2d6"><p class="cl-9be7e805"><span class="cl-9be69f30">89 (100.0%)</span></p></td><td class="cl-9be7f2d7"><p class="cl-9be7e805"><span class="cl-9be69f30">111 (100.0%)</span></p></td><td class="cl-9be7f2d7"><p class="cl-9be7e805"><span class="cl-9be69f30">113 (100.0%)</span></p></td><td class="cl-9be7f2d7"><p class="cl-9be7e805"><span class="cl-9be69f30">102 (100.0%)</span></p></td></tr></tbody></table></div>
</div>
</div>



</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">

</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div> ]]></description>
  <category>R</category>
  <category>API</category>
  <category>Summary Table</category>
  <category>GHO OData API</category>
  <guid>https://bejewelled-nougat-3b99a7.netlify.app/posts/gho_with_api/post.html</guid>
  <pubDate>Thu, 27 Jun 2024 22:00:00 GMT</pubDate>
  <media:content url="https://bejewelled-nougat-3b99a7.netlify.app/posts/gho_with_api/api.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
